Merging the samples...
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [01:46<49:51, 106.86s/it]  7%|▋         | 2/29 [02:03<24:19, 54.07s/it]  10%|█         | 3/29 [02:04<12:48, 29.57s/it] 14%|█▍        | 4/29 [02:05<07:36, 18.27s/it] 17%|█▋        | 5/29 [02:05<04:42, 11.75s/it] 21%|██        | 6/29 [02:05<03:00,  7.83s/it] 24%|██▍       | 7/29 [02:15<03:03,  8.36s/it] 28%|██▊       | 8/29 [02:16<02:09,  6.15s/it] 31%|███       | 9/29 [02:18<01:37,  4.87s/it] 34%|███▍      | 10/29 [02:21<01:22,  4.36s/it] 38%|███▊      | 11/29 [02:23<01:01,  3.39s/it] 41%|████▏     | 12/29 [02:25<00:52,  3.08s/it] 45%|████▍     | 13/29 [02:26<00:41,  2.57s/it] 48%|████▊     | 14/29 [02:28<00:34,  2.33s/it] 52%|█████▏    | 15/29 [02:30<00:31,  2.26s/it] 55%|█████▌    | 16/29 [02:36<00:41,  3.21s/it] 59%|█████▊    | 17/29 [02:45<01:01,  5.15s/it] 62%|██████▏   | 18/29 [02:53<01:04,  5.83s/it] 66%|██████▌   | 19/29 [02:57<00:54,  5.49s/it] 69%|██████▉   | 20/29 [02:58<00:36,  4.11s/it] 72%|███████▏  | 21/29 [02:59<00:24,  3.02s/it] 76%|███████▌  | 22/29 [03:00<00:17,  2.52s/it] 79%|███████▉  | 23/29 [03:01<00:12,  2.07s/it] 83%|████████▎ | 24/29 [03:07<00:15,  3.15s/it] 86%|████████▌ | 25/29 [03:15<00:19,  4.80s/it] 90%|████████▉ | 26/29 [03:24<00:18,  6.01s/it] 93%|█████████▎| 27/29 [03:32<00:13,  6.62s/it] 97%|█████████▋| 28/29 [03:39<00:06,  6.68s/it]100%|██████████| 29/29 [03:46<00:00,  6.74s/it]100%|██████████| 29/29 [03:46<00:00,  7.81s/it]
Merging Drokhlyansky_SCP1038_mli...
Merging Drokhlyansky_SCP1038_msi...
Merging Drokhlyansky_SCP1038_mli.glia...
Merging Drokhlyansky_SCP1038_mli.neur...
Merging Drokhlyansky_SCP1038_msi.glia...
Merging Drokhlyansky_SCP1038_msi.neur...
Merging Xu_GSE124880_GSE124880_PP_LP_mm10...
Merging Parigi_GSE163638_GSM4983266_IEC-Stroma-depleted...
Merging Parigi_GSE163638_GSM4983265_IEC-Stroma-control...
Merging Niec_GSE190037_GSM5712428_Colon_Lymphatics...
Merging Niec_GSE190037_GSM5712427_SISC_Lymphatics...
Merging Morarach_GSE149524_GSM4504450_P21_1...
Merging Morarach_GSE149524_GSM4504449_E18...
Merging Morarach_GSE149524_GSM4504448_E15...
Merging Morarach_GSE149524_GSM4504451_P21_2...
Merging Haber_GSE92332_GSE92332_SalmonellaInfect_UMIcounts.txt...
Merging Haber_GSE92332_GSE92332_SalmHelm_UMIcounts.txt...
Merging Haber_GSE92332_GSE92332_atlas_UMIcounts.txt...
Merging Haber_GSE92332_FAE_UMIcounts.txt...
Merging Ayyaz_GSE123516_GSM3308720_C07...
Merging Ayyaz_GSE123516_GSM3308719_C06...
Merging Ayyaz_GSE123516_GSM3308718_C05...
Merging Ayyaz_GSE123516_GSM3308717_C04...
Merging ext_L24854_CD-AOM-DSS-Epi_plus_DN-single-cell...
Merging ext_L24854_CD-AOM-DSS-Immune-single-cell...
Merging ext_L24854_HFD-AOM-DSS-Epi_plus_DN-single-cell...
Merging ext_L24854_HFD-AOM-DSS-Immune-single-cell...
Merging ext_L24854_LFD-AOM-DSS-Epi_plus_DN-single-cell...
Merging ext_L24854_LFD-AOM-DSS-Immune-single-cell...
Shape of merged object: (623465, 29923)
Calculating QC metrics for merged samples...
Normalizing merged samples...
Calculating HVGs...
Performing analytic Pearson residual normalization...
Computing neighbors...

UMAP of merged objects before integration
Saving the merged object...
Integrating samples by Harmony...
2022-10-20 19:04:59,473 - harmonypy - INFO - Iteration 1 of 30
2022-10-20 19:10:40,799 - harmonypy - INFO - Iteration 2 of 30
2022-10-20 19:16:21,124 - harmonypy - INFO - Iteration 3 of 30
2022-10-20 19:22:02,241 - harmonypy - INFO - Converged after 3 iterations
Reading merged object...
Number of cells: 623465
Running harmony ...
Computing neighbours ...
Saving the integrated object...
Clustering...
Computing neighbourhood graph... 
Leiden
Saving the object... atlas_integrated_clustered.h5ad...
Calculating DEGs per cluster...
  0%|          | 0/29 [00:00<?, ?it/s]  3%|▎         | 1/29 [02:02<57:05, 122.34s/it]  7%|▋         | 2/29 [02:19<27:12, 60.46s/it]  10%|█         | 3/29 [02:19<14:19, 33.04s/it] 14%|█▍        | 4/29 [02:20<08:29, 20.38s/it] 17%|█▋        | 5/29 [02:21<05:14, 13.09s/it] 21%|██        | 6/29 [02:21<03:20,  8.71s/it] 24%|██▍       | 7/29 [02:30<03:16,  8.93s/it] 28%|██▊       | 8/29 [02:32<02:17,  6.53s/it] 31%|███       | 9/29 [02:34<01:42,  5.13s/it] 34%|███▍      | 10/29 [02:37<01:26,  4.54s/it] 38%|███▊      | 11/29 [02:38<01:03,  3.52s/it] 41%|████▏     | 12/29 [02:40<00:53,  3.16s/it] 45%|████▍     | 13/29 [02:42<00:42,  2.63s/it] 48%|████▊     | 14/29 [02:43<00:35,  2.36s/it] 52%|█████▏    | 15/29 [02:46<00:31,  2.28s/it] 55%|█████▌    | 16/29 [02:51<00:41,  3.22s/it] 59%|█████▊    | 17/29 [03:01<01:01,  5.14s/it] 62%|██████▏   | 18/29 [03:08<01:03,  5.81s/it] 66%|██████▌   | 19/29 [03:13<00:54,  5.46s/it] 69%|██████▉   | 20/29 [03:13<00:36,  4.09s/it] 72%|███████▏  | 21/29 [03:14<00:23,  3.00s/it] 76%|███████▌  | 22/29 [03:15<00:17,  2.51s/it] 79%|███████▉  | 23/29 [03:16<00:12,  2.06s/it] 83%|████████▎ | 24/29 [03:22<00:15,  3.10s/it] 86%|████████▌ | 25/29 [03:30<00:19,  4.76s/it] 90%|████████▉ | 26/29 [03:39<00:17,  5.98s/it] 93%|█████████▎| 27/29 [03:47<00:13,  6.62s/it] 97%|█████████▋| 28/29 [03:54<00:06,  6.68s/it]100%|██████████| 29/29 [04:01<00:00,  6.75s/it]100%|██████████| 29/29 [04:01<00:00,  8.33s/it]
