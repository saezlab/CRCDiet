impot utils
sample_type = "atlas"
adata = utils.get_filtered_concat_data(sample_type)
gene_lst = ["Retnlg", "Ngp", "Mmp8", "Ifitm6", "Prok2", "Camp", "Lcn2", "Ly6c2", "Anxa1", "Lipg", "Ly6g", "Ltf", "R3hdm4", "Mgst1", "Dgat1", "S100a9", "Clec4a2", "S100a11", "Mmp25", "Ckap4", "Dstn", "Gyg", "Lrrk2", "Pglyrp1", "Scrg1", "S100a8", "Bmx", "Wfdc21", "Flot2", "Osm", "G6pdx", "Padi4", "Cnn2", "Tkt", "Rnf144a", "Atxn10", "Mapk13", "Pnkp", "Dhrs7", "S1pr4", "Arhgdib", "Arhgap15", "Serpinb1a", "Asb7", "Dhrs9", "Gm29264", "Rgs18", "Svil", "Stfa1", "Adam8", "Gpr27", "Itgb2l", "Add3", "Klf5", "Mtus1", "Rab3d", "Ggt1", "Msra", "Mgst2", "Triobp", "Qsox1", "Glrx", "Crispld2", "Lmo4", "Adpgk", "B230208H11Rik", "Stx11", "Lbr", "Pi16", "Stfa3", "Sri", "S100a6", "Anxa11", "Slc2a3", "Cfp", "Capns1", "Cmah", "Hjurp", "Slc25a24", "Xpc", "X9830107B12Rik", "Chil5", "Fam129a", "Hacd4", "Gpi1", "X1700047M11Rik", "Alox5ap", "Zfp516", "Aldh2", "Zfand4", "Hopx", "Rdh12", "E2f2", "Flna", "Mgam", "Dbnl", "Ube2h", "Atp11b", "Rab5if", "Vim", "Wfdc17", "Stfa2l1", "Ifitm1", "Tbc1d14", "Gm19696", "Cd244a", "Gpcpd1", "Ifitm2", "Unc119", "Cdc42se1", "Stk17b", "Arap3", "Zdhhc18", "AI467606", "St3gal4", "Selplg", "Picalm", "Ankrd44", "Itgb7", "Prr5l", "Siglece", "Rab11fip1", "Dnm2", "Hcls1", "Arhgap45", "Sema4a", "Spi1", "Diaph1", "Slpi", "Tmem268", "Cxcr2", "Mvp", "Il17ra", "Ypel3", "Vamp5", "Tagln2", "Rassf3", "Fbxl5", "Cd37", "Cdkn1b", "Cd84", "Rasa3", "Fabp5", "Adipor1", "Tgfbi", "Btg2", "Gm31814", "Ssh2", "Rab31", "Rassf5", "Sec14l1", "Usp32", "Pfkfb4", "Gsr", "Celf2", "Cd300lb", "Lcp1", "Taldo1", "Ier2", "Cd33", "Rasgrp2", "Gpx1", "Ep300", "Rps9", "Grina", "Zyx", "Ypel5", "D1Ertd622e", "Lipe", "AI839979", "Stk40", "Dleu2", "Cr1l", "Cdc42ep3", "X6430548M08Rik", "Rras", "Sorl1", "Gmfg", "Crk", "Ddx6", "Ucp2", "Ogt", "Notch2", "Sell", "Slc8b1", "Herpud1", "Gda", "Rnd1", "Pten", "Csf3r", "Slc40a1", "Nr3c1", "Ncf2", "Gpsm3", "Fpr2", "AB124611", "Cd300ld", "Carhsp1", "Ttc7", "Kras", "Cxcl10", "Rsad2", "Ifit2", "Ifit1", "Ifit3", "Gbp5", "Isg15", "Gbp2", "Oasl1", "Usp18", "Parp14", "Ccl5", "Ifit3b", "Ifi47", "Isg20", "Gbp7", "Ifi209", "Slfn5", "Ifi211", "Cmpk2", "Ifi204", "Plac8", "Ddx58", "Ly6i", "Gm13822", "Stat2", "AW112010", "Irgm1", "Rnf213", "Herc6", "Stat1", "Phf11b", "Trim30c", "Irf7", "Ctss", "Slfn4", "Zbp1", "Trafd1", "Pttg1", "Rtp4", "X9930111J21Rik2", "Ifih1", "Nlrc5", "Znfx1", "Slfn8", "Dtx3l", "Trim12c", "Igtp", "Trim30a", "Ifi208", "Ifit1bl1", "Psmb8", "Tor1aip1", "Parp10", "Sp100", "Casp4", "Irgm2", "Epsti1", "Sp110", "Rap2c", "Trim12a", "Ddx60", "Gm20559", "Ifi35", "AW011738", "Ifi206", "Ube2l6", "Oasl2", "Clec4a3", "Sppl2a", "Xaf1", "Gpr141", "Psme2", "Tent5a", "Nampt", "Trim30d", "Il18bp", "Steap4", "H2-T22", "Irf9", "Fgl2", "Samd9l", "Tor3a", "Treml4", "Smchd1", "Tap1", "Snx10", "Lacc1", "Prdx5", "Zc3hav1", "Marcksl1", "Usp25", "Irf2", "Tapbpl", "Ly6e", "Ifi27l2a", "Nfe2l2", "Bst2", "Traf1", "Tap2", "Cxcl3", "Cxcl2", "Phlda1", "Gpr84", "Srgn", "Nlrp3", "Nt5e", "Plaur", "Cxcr4", "Morrbid", "Slc2a1", "Bcl2a1b", "Chd7", "Ptgs2", "Ier3", "Havcr2", "G0s2", "Samsn1", "Nfkbia", "St3gal1", "Bcl2a1a", "Cd80", "Tes", "Btg1", "Mirt2", "Clec4e", "Ero1l", "Cks2", "Cd14", "Resf1", "Il1rn", "Trem1", "Pim1", "Ptafr", "Rbpj", "AA467197", "Col4a3bp", "Rhoh", "Emilin2", "Sra1", "Cish", "Slfn1", "Snap23", "Icam1", "Rnf149", "Mthfs", "Slc7a11", "Mefv", "Retreg1", "Bhlhe40", "Il1r2", "Ccr1", "Gm12840", "Smox", "Fcgr3", "Il1b", "Zfp36l1", "Trib1", "X2310001H17Rik", "Cpeb2", "Clec5a", "Cox17", "Pgam1", "Laptm5", "Plek", "Ifi207", "Lilrb4a", "Fcer1g", "Pnrc1", "Apbb1ip", "Scimp", "Itgam", "Bcl2a1d", "Rab20", "Cdk2ap2", "Ffar2", "Rab32", "Prdx6", "Cd44", "Cd47", "Creb5", "Cd300lf", "Jak2", "Ets2", "Cebpb", "Mcl1", "Ppp1r15a", "Mrpl52", "Card19", "Basp1", "Egr1", "Map1lc3b", "Xbp1", "Pik3ap1", "Sod2", "Upp1", "Gadd45b", "Tmbim6", "Atp6v0c", "Fth1", "Prss2", "Ddt", "Cst3", "Gngt2", "Ptgs1", "Ms4a6d", "Gpr171", "Cdkn1a", "H1f0", "Snrpg", "Rgs2", "Mt1", "Grcc10", "Cox6a1", "Entpd3", "Ccng1", "Mrpl42", "Timm10b", "Micos10", "D630023F18Rik", "Otulinl", "Nol7", "Cox8a", "Tmco1", "Atp5l", "Atp5g1", "Atp5o", "Rps21", "Nr4a2", "Hist1h2bc", "Hemk1", "Rps27l", "Cox16", "Cox7b", "Runx3", "Magoh", "B930036N10Rik", "Vps28", "Hist1h1c", "Ndufb3", "Ndufa13", "Adgre1", "Mrpl51", "Uqcr11", "Hnrnpa2b1", "Hspa14", "Cox7a2", "Dynll1", "Ndufaf8", "Pbxip1", "Ndufa12", "Wdr83os", "Ptpn7", "Reep5", "Elob", "Cmtm7", "Rps19", "Arrdc4", "Ndufa3", "Mdh2", "Naaa", "Nedd8", "Rgs10", "Atp5mpl", "Fam49b", "Ubl5", "Uqcr10", "Cox6b1", "Neurl3", "Romo1", "Ndufc1", "Dbi", "Ndufb4", "Runx1", "Snrpf", "Dad1", "Chchd2", "Cep83", "Krtcap2", "Timm13", "Muc1", "Mrps24", "Ssr4", "Ndufs5", "Mtss1", "Tmem258", "Lsm7", "Abracl", "Chchd1", "Atp5d", "Ybx1", "Tomm6", "P2ry13", "Dpm1", "Banf1", "Pmf1", "Cd81", "X1810037I17Rik", "Naip2", "Rpl22", "Gpnmb", "Itpr2", "Rnh1", "Gadd45g", "Gstm1", "Psap", "Cd63", "Cstb", "Mdm2", "Fnip2", "Rgs1", "Creg1", "Gns", "Atp6v1c1", "Pdcd1lg2", "Atp6v0d2", "Gpr137b", "Gdf15", "Spp1", "Atf3", "Gla", "Lrrfip2", "Ankrd12", "Lamp1", "Atp6v1a", "Tns3", "Npc1", "Ctsb", "Sqstm1", "Rab15", "Ccl2", "Ftl1", "Lgals3", "Anxa5", "Slc26a11", "Esd", "Lhfpl2", "Inhba", "Irak2", "Ifrd1", "Mreg", "A930007I19Rik", "Cd68", "Atp6v0c", "Syngr1", "Slc31a2", "Prdx1", "Dtnbp1", "Naa50", "Bri3", "Osbpl8", "Hcar2", "Ctsk", "Mcfd2", "Sgpl1", "Slc20a1", "Cited2", "Gnpda1", "Aph1c", "Tmem251", "Tpp1", "Eea1", "Lgmn", "Hspa9", "Amdhd2", "Atp6v1f", "Mpp1", "Ctsz", "Ddit3", "Hexa", "Uap1l1", "Dgkz", "Rnasek", "Gclm", "X1700017B05Rik", "Arl8b", "Stx3", "Srxn1", "Nceh1", "AI413582", "Atf5", "Gas2l3", "D730003I15Rik", "Jdp2", "Mbnl2", "Mafg", "Akr1a1", "Mfsd11", "Cyp4f18", "Gm20406", "Stxbp5", "St13", "Cpeb4", "Ccl3", "Tmem189", "Igf2r", "Eif5", "Dedd2", "Dtx4", "Vat1", "Adamdec1", "Cebpe", "Car4", "Lyz2", "Ctsc", "mt-Co2", "mt-Co3", "mt-Co1", "Ceacam10", "B4galt6", "Rps4x", "Mgll", "mt-Atp6", "mt-Nd1", "Fcnb", "Tuba4a", "Chil3", "Rps24", "Tmem256", "Nucb2", "Acp5", "Gnas", "Pmepa1", "mt-Nd4", "Epcam", "Gsn", "Actn1", "Rps6ka1", "Tubb5", "Atpif1", "Rogdi", "Cd200r1", "mt-Cytb", "Ahr", "Cd38", "Dok2", "Tmem160", "Jaml", "Abca13", "Rpl3", "Ctsh", "Ogfrl1", "Prtn3", "Hmgn2", "App", "Anxa3", "mt-Nd4l", "Tmsb10", "Hsd11b1", "Stap1", "Rpl29", "Mpc1", "Dock8", "Pak1", "Tmem205", "Eci2", "Hsp90ab1", "Kif1b", "Alox5", "Tle5", "Clint1", "Ppt1", "Rsu1", "Pdcl3", "Ppib", "Adgrg3", "Smpdl3a", "Tcn2", "Cstdc4", "Manf", "Pld3", "Rack1", "Fdps", "Shtn1", "Arl4c", "Hsp90b1", "Eif4g3", "Sptbn1", "Lta4h", "Gtf2ird1", "Paqr7", "Dbndd2", "Vps13c", "Bscl2", "Qpct", "Sdf2l1", "Gpd1l", "Ppdpf", "Pde4d", "Tmem123", "Cenpb", "Hif1a", "Dynlt3", "Rp9", "Smarca4", "Mbnl1", "Gpx4", "Fuca1", "Mapk3", "mt-Nd3"]

gene_lst = [gn.upper() for gn in gene_lst]


intersect_gene = list(set(adata.var_names)&set(gene_lst))

sc.pp.normalize_total(adata, target_sum=1e4)
sc.pp.log1p(adata)

adata_neut = sc.read_h5ad("/net/data.isilon/ag-saez/bq_arifaioglu/home/Projects/CRCDiet/data/out_data/atlas_bcell1_neutrophils_igaplasma.h5ad")
adata_neut = adata_neut[adata_neut.obs["cell_type"]=="Neutrophils",:]

adata_all_gene_neut = adata[adata.obs_names.isin(adata_neut.obs_names),:]
adata_all_gene_neut.var_names_make_unique()

